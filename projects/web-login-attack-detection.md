# Website Defacement – Root Cause Analysis

## Lab Context

This project is based on a simulated incident scenario and log data provided by the TryHackMe platform.  
All activity, IP addresses, and infrastructure are part of a controlled lab environment used for educational purposes.

## 1. Incident Summary
A public-facing website was reported as defaced, displaying unauthorized content.
An investigation was conducted to determine how the attacker gained access and
to identify the root cause of the compromise.

---

## 2. Investigation Objectives
- Identify when the defacement occurred
- Determine how the attacker gained access
- Identify indicators of compromise (IOCs)
- Provide remediation and prevention recommendations

---

## 3. Data Sources
- HTTP access logs
- Web server logs
- SIEM platform (Splunk)
- Sourcetype: http / web / stream:http

---

## 4. Investigation Timeline

### Step 1: Reconnaissance Phase: Identify defaced domain activity
The investigation began by searching for the domain **imreallynotbatman.com**, which the website had been redirected to. This search was performed across the web log index to identify related HTTP activity and establish a starting point for reconnaissance.


![Defacing_Reconnaissance](images/Defacing_Reconnaissance.png)

The next step was to identify the source IP address responsible for reconnaissance activity against the web server.

![Identify_reconnaissance_source_IP](images/Identify_reconnaissance_source_IP.png)

The source IP address was validated through analysis of Suricata-generated IDS/IPS alerts, confirming reconnaissance-related activity.
index="botsv1" sourcetype=suricata imreallynotbatman src_ip="40.80.148.xx"

![Validate_IP_By_Suricata](images/Validate_IP_By_Suricata.png)

### Step 2: Exploitation Phase: Analyze potential exploitation attempts
The investigation focused on analyzing potential exploitation attempts against the web server to determine whether the attacker was successful.

First we want to see the number of occurrences for each source IP address with this query: 
![Search_Query_Number_of_ip_Addresses](images/Search_Query_Number_of_ip_Addresses.png)

Then this query was executed to enumerate source IP addresses associated with inbound HTTP traffic to the web server.
![IP_Http_Traffic_To_Webserver.png](images/IP_Http_Traffic_To_Webserver.png)

The http_method field provides information about the HTTP methods observed during these communications.
![Http_Methods_For_Webserver.png](images/Http_Methods_For_Webserver.png)

The src_ip results reveal that POST request activity was exclusively generated by two source IP addresses.
The following query was used to support this analysis: 
index=botsv1 sourcetype=stream:http dest_ip="192.168.250.xx" http_method=POST

The presence of Joomla in multiple web server fields indicates that the backend web application is running the Joomla CMS. The default Joomla administrative login page is located at /joomla/administrator/index.php, which provides access to the web portal’s admin interface. Traffic targeting this endpoint was analyzed to identify potential malicious activity, including possible brute‑force login attempts.
Based on the identification of the Joomla CMS and its administrative login page (`/joomla/administrator/index.php`), the investigation was scoped to examine only requests targeting this endpoint. The following search query was used to filter relevant traffic and identify potential malicious activity.
![Joomla_BruteForce.png](images/Joomla_BruteForce.png)

The query results indicate that the attacker from IP `23.22.63.114` attempted a brute-force attack, repeatedly trying different passwords to gain access to the administrative login.

After running several search queries, the results indicated a sustained brute-force attack originating from IP 23.22.63.114, along with a single password attempt using “batman” from IP 40.80.148.42 via a Mozilla browser.

### Step 3: Installation Phase

The investigation revealed that iamreallynotbatman.com was compromised via a brute-force attack conducted with an automated Python script. Two separate IP addresses were involved, one used to carry out the password-guessing attack and another to access the server after successful authentication. This phase examines the server for any malicious files or payloads that may have been uploaded following the compromise.

The investigation identified an .exe file present on the server, which was traced back to one of the malicious IP addresses discovered during the previous phase.
![ExeFile_Source.png](images/ExeFile_Source.png)

